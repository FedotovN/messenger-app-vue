"use strict";(self["webpackChunkchat_app_vue"]=self["webpackChunkchat_app_vue"]||[]).push([[726],{8726:function(e,i,a){a.r(i),a.d(i,{default:function(){return y}});var t=a(3396),s=a(9242);const l={key:0,class:"profile_page_handler"},n={key:1,class:"profile_page_wrapper"},o={class:"row"},r=(0,t._)("h3",null,"Профиль",-1),d={class:"form_main"},h={class:"photo_wrapper"},u=["src"],c={key:1},p={key:2,class:"fa-regular fa-file-image"},f={class:"form_end"};function g(e,i,a,g,m,_){const k=(0,t.up)("base-loader"),w=(0,t.up)("base-button"),v=(0,t.up)("base-input");return m.loading?((0,t.wg)(),(0,t.iD)("div",l,[(0,t.Wm)(k)])):((0,t.wg)(),(0,t.iD)("div",n,[(0,t._)("div",o,[r,(0,t.Wm)(w,{class:"danger",onClick:_.logOut},{default:(0,t.w5)((()=>[(0,t.Uk)("Выход")])),_:1},8,["onClick"])]),(0,t._)("form",{onSubmit:i[3]||(i[3]=(0,s.iM)(((...e)=>_.handleForm&&_.handleForm(...e)),["prevent"]))},[(0,t._)("div",d,[(0,t._)("div",h,[(0,t._)("div",{class:"input_photo",onClick:i[1]||(i[1]=i=>e.$refs.input.click())},[m.file?((0,t.wg)(),(0,t.iD)("img",{key:0,src:m.file,alt:"Profile photo",ref:"imagePreview"},null,8,u)):(0,t.kq)("",!0),(0,t._)("input",{ref:"input",type:"file",onChange:i[0]||(i[0]=(...e)=>_.fileLoaded&&_.fileLoaded(...e))},null,544),m.file?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("p",c,"700 кб")),m.file?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("i",p))])]),(0,t.Wm)(v,{modelValue:m.name,"onUpdate:modelValue":i[2]||(i[2]=e=>m.name=e),label:"Имя",placehldr:"Введите имя пользователя"},null,8,["modelValue"])]),(0,t._)("div",f,[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Принять")])),_:1})])],32)]))}a(7658);var m=a(7732),_=a(1294),k={name:"ProfilePage",data(){return{loading:!0,file:"",name:"",changed:!1}},methods:{async handleForm(){if(this.loading=!0,this.$store.dispatch("setUserName",this.name),this.file){if(this.changed){const e=await this.$store.dispatch("getUid"),i=(0,_.iH)(m.tO,`usersPhotos/${e}`);await(0,_.sf)(i,this.file,"data_url",{contentType:"image/jpeg"}),await this.$store.dispatch("setUserPhoto")}this.loading=!1,this.$router.push("/")}},logOut(){this.$store.dispatch("logOut"),this.$router.push("/login")},fileLoaded(e){this.loading=!0;const i=e.target.files[0],a=new FileReader;if(i.size/1024>700)return alert("Извините, мы не принимаем картинки весом более 700 кб"),void(this.loading=!1);a.onloadend=()=>{this.file=a.result,this.loading=!1,this.changed=!0},a.readAsDataURL(i)}},async mounted(){this.loading=!0;const e=await this.$store.dispatch("getCurrentUserInfo");this.name=e.name,this.file=e.photoUrl,this.loading=!1}},w=a(89);const v=(0,w.Z)(k,[["render",g]]);var y=v}}]);
//# sourceMappingURL=726.620d5576.js.map