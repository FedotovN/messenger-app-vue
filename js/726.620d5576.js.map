{"version":3,"file":"js/726.620d5576.js","mappings":"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","sources":["webpack://chat-app-vue/./src/views/ProfilePage.vue","webpack://chat-app-vue/./src/views/ProfilePage.vue?ccbe"],"sourcesContent":["<template>\r\n  <div class=\"profile_page_handler\" v-if=\"loading\">\r\n    <base-loader></base-loader>\r\n  </div>\r\n  <div class=\"profile_page_wrapper\" v-else>\r\n    <div class=\"row\">\r\n      <h3>Профиль</h3>\r\n      <base-button class=\"danger\" @click=\"logOut\">Выход</base-button>\r\n    </div>\r\n    <form @submit.prevent=\"handleForm\">\r\n      <div class=\"form_main\">\r\n\r\n        <div class=\"photo_wrapper\">\r\n          <div class=\"input_photo\" @click=\"$refs.input.click()\">\r\n            <img :src=\"file\" alt=\"Profile photo\" ref=\"imagePreview\" v-if=\"file\">\r\n            <input ref=\"input\" type=\"file\" @change=\"fileLoaded\">\r\n            <p v-if=\"!file\">700 кб</p>\r\n            <i v-if=\"!file\" class=\"fa-regular fa-file-image\"></i>\r\n          </div>\r\n        </div>\r\n\r\n        <base-input\r\n        v-model=\"name\"\r\n        :label=\"'Имя'\"\r\n        :placehldr=\"'Введите имя пользователя'\"\r\n        />\r\n      </div>\r\n        <div class=\"form_end\">\r\n          <base-button>Принять</base-button>\r\n        </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {storage} from '@/firebase/config'\r\nimport {ref, uploadString} from 'firebase/storage'\r\n\r\nexport default {\r\n  name: 'ProfilePage',\r\n  data(){\r\n    return {\r\n      loading: true,\r\n      file: '',\r\n      name: '',\r\n      changed: false\r\n    }\r\n  },\r\n  methods: {\r\n    async handleForm(){\r\n      this.loading = true\r\n      this.$store.dispatch('setUserName', this.name)\r\n      if(!this.file) return\r\n      if(this.changed) {\r\n        const uid = await this.$store.dispatch('getUid'),\r\n              reference = ref(storage, `usersPhotos/${uid}`)\r\n        await uploadString(reference, this.file, 'data_url', {contentType: \"image/jpeg\"})\r\n\r\n        await this.$store.dispatch('setUserPhoto')\r\n      }\r\n      this.loading = false\r\n      this.$router.push('/')\r\n    },\r\n    logOut() {\r\n      this.$store.dispatch('logOut')\r\n      this.$router.push('/login')\r\n    },\r\n    fileLoaded(e) {\r\n      this.loading = true\r\n      const image = e.target.files[0],\r\n      reader = new FileReader()\r\n      if(image.size / 1024 > 700) {\r\n          alert('Извините, мы не принимаем картинки весом более 700 кб')\r\n          this.loading = false\r\n          return\r\n      }\r\n      \r\n      reader.onloadend = () => {\r\n        this.file = reader.result\r\n        this.loading = false\r\n        this.changed = true\r\n      }\r\n      \r\n      reader.readAsDataURL(image)\r\n    }\r\n  },\r\n  async mounted() {\r\n    this.loading = true\r\n    const info =  await this.$store.dispatch('getCurrentUserInfo') \r\n    this.name = info.name\r\n    this.file = info.photoUrl\r\n    \r\n    this.loading = false\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  .profile_page_wrapper {\r\n    padding-bottom: 10px;\r\n    flex: 1;\r\n    display: flex;\r\n    flex-flow: column nowrap;\r\n    .row {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 70px;\r\n    }\r\n    form {\r\n      display: flex;\r\n      flex-flow: column nowrap;\r\n      padding-top: 20px;\r\n      flex: 1;\r\n      .form_main {\r\n        flex: 1;\r\n        display: flex;\r\n        flex-flow: column nowrap;\r\n        gap: 10px;\r\n        .photo_wrapper {\r\n          width: 100%;\r\n          display: flex;\r\n          justify-content: center;\r\n          .input_photo {\r\n              cursor: pointer;\r\n              margin-top: 20px;\r\n              border: 3px dashed $grey-color;\r\n              height: 150px;\r\n              width: 150px;\r\n              border-radius: 50%;\r\n              display: flex;\r\n              flex-flow: column nowrap;\r\n              gap: 20px;\r\n              justify-content: center;\r\n              align-items: center;\r\n              color: $grey-color;\r\n              user-select: none;\r\n              transition: .3s;\r\n              overflow: hidden;\r\n              img {\r\n                  max-width: 100%;\r\n                  object-fit: cover;\r\n                  &.hidden {\r\n                      display: none;\r\n                  }\r\n              }\r\n              &:hover {\r\n                  border-color: $accent-color;\r\n                  color: $accent-color;\r\n              }\r\n              i {\r\n                  font-size: 26px;\r\n              }\r\n              input {\r\n                  display: none;\r\n              }\r\n          }\r\n        }\r\n      }\r\n      .form_end {\r\n        padding-top: 20px;\r\n      }\r\n    };\r\n  }\r\n  .profile_page_handler {\r\n    z-index: 20;\r\n    background-color: rgba($dark-color, .9);\r\n    position: fixed;\r\n    top: 0;\r\n    right: 0;\r\n    left: 0;\r\n    bottom: 0;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n</style>","import { render } from \"./ProfilePage.vue?vue&type=template&id=9f8d2c62\"\nimport script from \"./ProfilePage.vue?vue&type=script&lang=js\"\nexport * from \"./ProfilePage.vue?vue&type=script&lang=js\"\n\nimport \"./ProfilePage.vue?vue&type=style&index=0&id=9f8d2c62&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\User\\\\Desktop\\\\vue\\\\chat\\\\chat-app-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","$data","loading","_createElementBlock","_hoisted_1","_createVNode","_component_base_loader","_hoisted_2","_hoisted_3","_hoisted_4","_component_base_button","onClick","$options","logOut","onSubmit","_cache","_withModifiers","args","handleForm","_hoisted_5","_hoisted_6","$event","_ctx","$refs","input","click","file","src","alt","ref","type","onChange","fileLoaded","_hoisted_8","_hoisted_9","_component_base_input","name","label","placehldr","_hoisted_10","data","changed","methods","async","this","$store","dispatch","uid","reference","storage","uploadString","contentType","$router","push","e","image","target","files","reader","FileReader","size","alert","onloadend","result","readAsDataURL","info","photoUrl","__exports__","render"],"sourceRoot":""}